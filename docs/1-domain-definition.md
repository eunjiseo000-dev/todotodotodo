# ToDoToDoToDo 도메인 정의서

## 1. 개요

### 1.1 목적

ToDoToDoToDo는 개인 사용자가 할일을 체계적으로 관리할 수 있는 웹 기반 할일 관리 애플리케이션입니다.

### 1.2 핵심 가치

- 사용자별 독립적인 할일 관리
- 시작일과 종료일 기반의 일정 관리
- 완료 여부 추적을 통한 생산성 향상
- 실수로 삭제한 데이터의 복구 가능성

## 2. 사용자

### 2.1 사용자 유형

| 유형   | 설명                                  | 권한           |
| ------ | ------------------------------------- | -------------- |
| 비회원 | 회원가입 및 로그인 페이지만 접근 가능 | 제한적         |
| 회원   | 회원가입 후 로그인한 사용자           | 전체 기능 사용 |

### 2.2 사용자 특징

- 각 사용자는 독립적인 할일 목록을 소유
- 다른 사용자의 할일 목록에 접근 불가
- 자신의 데이터에 대한 완전한 제어권 보유

## 3. 핵심 개념 및 엔티티

### 3.1 사용자 (User)

**속성:**
| 속성명 | 데이터 타입 | 필수 여부 | 설명 |
|--------|------------|----------|------|
| 사용자 ID | UUID | 필수 | 고유 식별자 |
| 이메일 | String(255) | 필수 | RFC 5322 형식, 중복 불가 |
| 비밀번호 | String(100) | 필수 | 해시 저장, 8자 이상 |
| 이름 | String(50) | 필수 | 사용자 이름 (2-50자) |
| 가입일시 | DateTime (ISO 8601) | 자동 | 계정 생성 시각 |

**관계:**

- 사용자는 여러 개의 할일을 소유

### 3.2 할일 (ToDo)

**속성:**
| 속성명 | 데이터 타입 | 필수 여부 | 설명 |
|--------|------------|----------|------|
| 할일 ID | UUID | 필수 | 고유 식별자 |
| 사용자 ID | UUID | 필수 | 소유자 참조 (FK) |
| 제목 | String(500) | 필수 | 할일 제목 (1-500자) |
| 시작일 | Date (YYYY-MM-DD) | 필수 | 할일 시작 날짜 |
| 종료일 | Date (YYYY-MM-DD) | 필수 | 할일 종료 날짜 |
| 표시 순서 | Integer | 필수 | 목록 내 정렬 순서 (작을수록 상위) |
| 완료 여부 | Boolean | 필수 | true: 완료, false: 진행중 |
| 삭제 여부 | Boolean | 필수 | true: 삭제됨, false: 활성 |
| 생성일시 | DateTime (ISO 8601) | 자동 | 생성 시각 |
| 수정일시 | DateTime (ISO 8601) | 자동 | 마지막 수정 시각 |
| 삭제일시 | DateTime (ISO 8601) | 조건부 | 삭제 시각 (삭제된 경우만) |

**상태:**

- **진행중**: 완료되지 않은 활성 할일
- **완료**: 완료 여부가 체크된 할일
- **삭제**: 휴지통으로 이동된 할일

**관계:**

- 할일은 한 명의 사용자에게 소속

### 3.3 할일 분류 체계

```
전체 할일
├── 활성 할일
│   ├── 진행중 (완료 여부: false)
│   └── 완료 (완료 여부: true)
└── 휴지통 (삭제 여부: true)
```

## 4. 주요 기능

### 4.1 인증 및 권한 관리

| 기능     | 설명                  | 비회원 | 회원 |
| -------- | --------------------- | ------ | ---- |
| 회원가입 | 신규 사용자 계정 생성 | O      | -    |
| 로그인   | 사용자 인증           | O      | O    |
| 로그아웃 | 세션 종료             | -      | O    |

### 4.2 할일 관리

| 기능           | 설명                          | 입력 데이터              |
| -------------- | ----------------------------- | ------------------------ |
| 할일 조회      | 자신의 할일 목록 확인         | -                        |
| 할일 추가      | 새로운 할일 등록              | 내용, 시작일, 종료일     |
| 할일 수정      | 기존 할일 정보 변경           | 내용, 시작일, 종료일     |
| 할일 순서 변경 | 할일의 우선순위(순서) 변경    | 할일 ID, 새로운 우선순위 |
| 할일 삭제      | 할일을 휴지통으로 이동        | 할일 ID                  |
| 할일 복원      | 휴지통에서 활성 목록으로 복원 | 할일 ID                  |
| 할일 영구삭제  | 휴지통에서 할일을 영구 삭제   | 할일 ID                  |
| 완료 체크      | 할일 완료 여부 토글           | 완료 여부                |

### 4.3 할일 필터링 및 분류

- **진행중 목록**: 완료되지 않은 활성 할일만 표시
- **완료 목록**: 완료된 할일만 표시
- **휴지통**: 삭제된 할일만 표시

## 5. 비즈니스 규칙

### 5.1 데이터 무결성

1. 모든 할일은 반드시 한 명의 사용자에게 소속되어야 함
2. 할일 내용은 필수 입력 항목
3. 시작일은 종료일보다 이전이거나 같아야 함
4. 삭제된 할일은 수정 불가 (복원 후 수정 가능)

### 5.2 접근 권한

1. 비회원은 할일 관리 기능에 접근 불가
2. 사용자는 자신의 할일만 조회/수정/삭제 가능
3. 다른 사용자의 할일에 대한 접근 시도는 차단

### 5.3 삭제 정책

1. 할일 삭제 시 물리적 삭제가 아닌 논리적 삭제 (Soft Delete) 적용
2. 휴지통의 할일은 언제든지 복원 가능
3. 완료된 할일도 삭제 가능
4. 휴지통의 할일은 영구 삭제 가능 (복구 불가)
5. 영구 삭제된 할일은 데이터베이스에서 물리적으로 제거됨

### 5.4 완료 관리

1. 완료 여부는 언제든지 토글 가능
2. 완료된 할일은 별도의 완료 목록에서 확인
3. 완료 후에도 수정 가능

### 5.5 우선순위 관리

1. 각 할일은 우선순위(순서) 값을 가짐
2. 사용자가 드래그 앤 드롭 또는 순서 변경 기능으로 할일 순서 수정 가능
3. 우선순위는 카테고리별(진행중/완료) 또는 전체적으로 관리 가능
4. 새로운 할일 추가 시 기본 우선순위는 목록의 마지막

## 6. 제약사항

### 6.1 기술적 제약

- 웹 브라우저 기반 애플리케이션
- 인터넷 연결 필수

### 6.2 기능적 제약

- 할일 공유 기능 미제공 (개인 전용)
- 할일 협업 기능 미제공
- 파일 첨부 기능 미제공
- 알림/리마인더 기능 미제공

### 6.3 데이터 제약

- 할일 내용 길이 제한 (구체적 수치는 구현 단계에서 결정)
- 사용자당 할일 개수 제한 없음 (시스템 리소스 범위 내)

## 7. 용어 정의

| 용어        | 정의                                             |
| ----------- | ------------------------------------------------ |
| 활성 할일   | 삭제되지 않은 할일 (진행중 + 완료)               |
| 진행중 할일 | 완료되지 않은 활성 할일                          |
| 완료 할일   | 완료 체크된 활성 할일                            |
| 휴지통      | 삭제된 할일이 임시 보관되는 공간                 |
| 논리적 삭제 | 데이터를 실제로 삭제하지 않고 삭제 플래그만 변경 |
| 복원        | 휴지통의 할일을 활성 상태로 되돌림               |

## 8. 도메인 모델 관계도

```
[User] 1 -------- * [ToDo]

User:
- userId (PK)
- email
- password
- name
- createdAt

ToDo:
- todoId (PK)
- userId (FK)
- content
- startDate
- endDate
- priority (순서 값)
- isCompleted
- isDeleted
- createdAt
- updatedAt
- deletedAt
```

## 9. 핵심 시나리오

### 9.1 기본 사용 흐름

1. 사용자 회원가입
2. 로그인
3. 할일 추가 (내용, 시작일, 종료일 입력)
4. 할일 목록 조회
5. 할일 진행 중 완료 체크
6. 완료 목록에서 완료된 할일 확인
7. 필요 시 할일 수정 또는 삭제
8. 휴지통에서 삭제된 할일 확인 및 복원

### 9.2 예외 시나리오

- 잘못 삭제한 할일을 휴지통에서 복원
- 완료 체크를 실수로 한 경우 체크 해제
- 일정 변경에 따른 시작일/종료일 수정
- 할일의 우선순위를 변경하여 목록 순서 재정렬
- 휴지통의 할일을 영구 삭제하여 더 이상 복원 불가

## 10. 비기능적 요구사항

### 10.1 성능 요구사항

| 항목              | 기준            | 설명                   |
| ----------------- | --------------- | ---------------------- |
| API 응답 시간     | 평균 500ms 이하 | 데이터베이스 조회 포함 |
| 페이지 로딩 시간  | 2초 이내        | 초기 페이지 로딩       |
| 동시 접속 사용자  | 최대 10,000명   | 일일 피크 시간 기준    |
| 데이터베이스 조회 | 50ms 이하       | 일반적인 쿼리          |

### 10.2 보안 요구사항

| 항목          | 정책                                   | 설명                 |
| ------------- | -------------------------------------- | -------------------- |
| 비밀번호      | 최소 8자, 영문/숫자/특수문자 조합 필수 | 강력한 패스워드 정책 |
| 세션 관리     | 30분 비활동 시 자동 로그아웃           | 세션 보안            |
| 인증 토큰     | JWT, 24시간 유효기간                   | 상태 비저장 인증     |
| HTTPS         | 모든 통신 암호화 필수                  | 전송 보안            |
| 비밀번호 저장 | bcrypt로 해시 저장                     | 저장 보안            |

### 10.3 신뢰성 요구사항

| 항목           | 기준           |
| -------------- | -------------- |
| 시스템 가용성  | 99.9% 업타임   |
| 데이터 백업    | 일일 자동 백업 |
| 장애 복구 시간 | 1시간 이내     |
| 데이터 일관성  | ACID 보장      |

### 10.4 확장성 요구사항

| 항목                | 기준                                 |
| ------------------- | ------------------------------------ |
| 사용자 확장         | 연 100% 증가 대응 가능               |
| 할일 개수           | 사용자당 무제한 (시스템 리소스 범위) |
| 데이터 저장         | 클라우드 스토리지 지원               |
| 마이크로서비스 준비 | 모듈식 설계 고려                     |

## 11. 데이터 검증 상세 규칙

### 11.1 사용자 데이터 검증

| 필드     | 최소 | 최대  | 형식           | 필수 | 에러 메시지                                                 |
| -------- | ---- | ----- | -------------- | ---- | ----------------------------------------------------------- |
| 이메일   | -    | 255자 | RFC 5322       | O    | "유효한 이메일 형식이 아닙니다"                             |
| 비밀번호 | 8자  | 100자 | 영문+숫자+특수 | O    | "비밀번호는 8자 이상, 영문/숫자/특수문자 조합이어야 합니다" |
| 이름     | 2자  | 50자  | UTF-8          | O    | "이름은 2-50자 사이여야 합니다"                             |

### 11.2 할일 데이터 검증

| 필드      | 최소 | 최대   | 형식       | 필수 | 에러 메시지                       |
| --------- | ---- | ------ | ---------- | ---- | --------------------------------- |
| 제목      | 1자  | 500자  | UTF-8      | O    | "제목은 1-500자 사이여야 합니다"  |
| 시작일    | -    | -      | YYYY-MM-DD | O    | "유효한 날짜 형식이 아닙니다"     |
| 종료일    | -    | -      | YYYY-MM-DD | O    | "유효한 날짜 형식이 아닙니다"     |
| 표시 순서 | 1    | 999999 | Integer    | O    | "순서는 1 이상의 숫자여야 합니다" |

### 11.3 날짜 검증 규칙

| 조건                             | 결과 | 에러 메시지                                |
| -------------------------------- | ---- | ------------------------------------------ |
| 시작일 = 종료일                  | 성공 | -                                          |
| 시작일 < 종료일                  | 성공 | -                                          |
| 시작일 > 종료일                  | 실패 | "시작일은 종료일 이전이거나 같아야 합니다" |
| 시작일 = null 또는 종료일 = null | 실패 | "시작일과 종료일은 필수 입력입니다"        |

## 12. 추적성 매트릭스

### 12.1 요구사항 ID 체계

| ID      | 유형   | 내용                     | 우선순위 | 상태   |
| ------- | ------ | ------------------------ | -------- | ------ |
| FR-001  | 기능   | 회원가입 기능            | High     | 정의됨 |
| FR-002  | 기능   | 로그인 기능              | High     | 정의됨 |
| FR-003  | 기능   | 로그아웃 기능            | Medium   | 정의됨 |
| FR-004  | 기능   | 할일 조회 기능           | High     | 정의됨 |
| FR-005  | 기능   | 할일 추가 기능           | High     | 정의됨 |
| FR-006  | 기능   | 할일 수정 기능           | Medium   | 정의됨 |
| FR-007  | 기능   | 할일 삭제 기능           | Medium   | 정의됨 |
| FR-008  | 기능   | 할일 복원 기능           | Medium   | 정의됨 |
| FR-009  | 기능   | 완료 여부 토글           | High     | 정의됨 |
| FR-010  | 기능   | 순서 변경 기능           | Low      | 정의됨 |
| FR-011  | 기능   | 할일 영구삭제 기능       | Medium   | 정의됨 |
| BR-001  | 규칙   | 시작일 ≤ 종료일 검증     | High     | 정의됨 |
| BR-002  | 규칙   | Soft Delete 적용         | High     | 정의됨 |
| BR-003  | 규칙   | 사용자별 접근 제한       | High     | 정의됨 |
| BR-004  | 규칙   | 완료된 할일 수정 가능    | Medium   | 정의됨 |
| NFR-001 | 비기능 | API 응답 시간 500ms 이하 | High     | 정의됨 |
| NFR-002 | 비기능 | HTTPS 필수 암호화        | High     | 정의됨 |
| NFR-003 | 비기능 | 99.9% 가용성             | Medium   | 정의됨 |

### 12.2 기능-엔티티 매핑

| 요구사항 ID | 기능          | 사용 엔티티 | 입력                   | 출력              |
| ----------- | ------------- | ----------- | ---------------------- | ----------------- |
| FR-001      | 회원가입      | User        | 이메일, 비밀번호, 이름 | 사용자 ID, 토큰   |
| FR-002      | 로그인        | User        | 이메일, 비밀번호       | 토큰, 사용자 정보 |
| FR-004      | 할일 조회     | User, ToDo  | -                      | 할일 목록         |
| FR-005      | 할일 추가     | User, ToDo  | 제목, 시작일, 종료일   | 할일 ID           |
| FR-006      | 할일 수정     | ToDo        | 제목, 시작일, 종료일   | 수정된 할일       |
| FR-009      | 완료 토글     | ToDo        | 완료 여부              | 업데이트된 할일   |
| FR-010      | 순서 변경     | ToDo        | 할일 ID, 새 순서       | 업데이트된 할일   |
| FR-011      | 할일 영구삭제 | ToDo        | 할일 ID                | 삭제 완료 메시지  |

## 13. 수용 기준 (Acceptance Criteria)

### 13.1 FR-001: 회원가입 기능

**GIVEN** 로그인하지 않은 사용자가 회원가입 페이지에 접근
**WHEN** 유효한 이메일, 비밀번호, 이름을 입력하고 가입 버튼 클릭
**THEN**

- 사용자가 데이터베이스에 저장됨
- 비밀번호는 bcrypt로 해시 저장됨
- 로그인 페이지로 리다이렉트됨
- "가입이 완료되었습니다. 로그인하세요" 메시지 표시

### 13.2 FR-005: 할일 추가 기능

**GIVEN** 로그인한 사용자가 할일 추가 폼에 접근
**WHEN** 유효한 데이터(제목 1-500자, 시작일, 종료일)를 입력하고 저장 버튼 클릭
**THEN**

- 할일이 데이터베이스에 저장됨
- 할일 목록 화면으로 리다이렉트
- 새로 추가된 할일이 목록 맨 아래에 표시됨
- 성공 메시지 "할일이 추가되었습니다" 표시
- 표시 순서는 현재 최고 순서값 + 1로 설정됨

### 13.3 FR-009: 완료 여부 토글

**GIVEN** 사용자가 진행중 목록에서 할일 항목을 봄
**WHEN** 완료 체크박스를 클릭
**THEN**

- 해당 할일의 완료 여부가 true로 변경됨
- 화면에서 즉시 완료 목록으로 이동 (또는 스타일 변경)
- 성공 메시지 "할일이 완료되었습니다" 표시
- 진행중 목록에서 제거됨
- 완료 목록에서 확인 가능

### 13.4 FR-010: 순서 변경 기능

**GIVEN** 사용자가 할일 목록을 봄
**WHEN** 할일을 드래그하여 새로운 위치로 이동
**THEN**

- 해당 할일과 이동 영역의 다른 할일들의 표시 순서가 재계산됨
- 변경사항이 데이터베이스에 저장됨
- 화면에 반영된 새 순서가 유지됨
- 성공 메시지 표시

### 13.5 BR-001: 날짜 검증

**테스트 케이스:**
| 시작일 | 종료일 | 예상 결과 | 상태 |
|--------|--------|----------|------|
| 2025-01-01 | 2025-01-01 | 성공 | 같은 날짜 허용 |
| 2025-01-01 | 2025-01-05 | 성공 | 시작일 < 종료일 |
| 2025-01-05 | 2025-01-01 | 실패 | 시작일 > 종료일 불가 |
| 2025-01-01 | null | 실패 | 종료일 필수 |
| null | 2025-01-01 | 실패 | 시작일 필수 |

### 13.6 FR-011: 할일 영구삭제 기능

**GIVEN** 사용자가 휴지통에서 삭제된 할일을 봄
**WHEN** 할일 옆의 영구 삭제 버튼을 클릭 후 "정말 삭제하겠습니까?" 확인 창에서 확인
**THEN**

- 해당 할일이 데이터베이스에서 물리적으로 삭제됨
- 휴지통에서 즉시 제거됨
- 이후 복원 불가 (복원 옵션 없음)
- 성공 메시지 "할일이 영구 삭제되었습니다" 표시
- 삭제 확인 창 없이 삭제 시도 시 실패

**테스트 케이스:**
| 상황 | 예상 결과 |
|------|----------|
| 휴지통의 할일 영구삭제 | 데이터베이스에서 완전 제거 |
| 영구삭제 후 복원 시도 | 할일을 찾을 수 없음 (404) |
| 확인 창에서 취소 | 삭제되지 않음 |
| 확인 창에서 확인 | 영구 삭제 실행 |

## 14. 설계 의사결정 기록 (ADR)

### ADR-001: Soft Delete 방식 채택

**날짜:** 2025-11-25
**상태:** 승인됨
**컨텍스트:** 사용자가 실수로 삭제한 할일을 복구하고 싶어하는 요구사항 존재
**결정:** 물리적 삭제(Hard Delete) 대신 논리적 삭제(Soft Delete) 방식 채택
**근거:**

- 사용자 실수 복구 가능
- 데이터 복구가 즉시 가능 (백업 불필요)
- 삭제 이력 추적 용이

**대안:**

- Hard Delete + 백업 복원: 복구 프로세스 복잡, 시간 소요
- 삭제 아카이브 테이블 분리: 구조 복잡도 증가

**영향:**

- 데이터베이스 용량 증가 가능성
- 모든 쿼리에 `isDeleted = false` 조건 필수

### ADR-002: 우선순위 - 정수형 순서 값 사용

**날짜:** 2025-11-25
**상태:** 승인됨
**컨텍스트:** 할일 목록의 우선순위를 어떻게 표현할지 결정 필요
**결정:** 문자열 우선순위(HIGH, MEDIUM, LOW) 대신 정수형 순서 값(1, 2, 3...) 사용
**근거:**

- 사용자가 원하는 대로 순서 조정 가능
- 드래그 앤 드롭으로 자연스러운 조작
- 데이터베이스 쿼리에서 정렬이 간단함

**대안:**

- 문자열 우선순위: 사용자 맞춤 순서 조정 불가
- 부동소수점(0.5, 1.5): 복잡도 증가

**영향:**

- 순서 변경 시 다른 할일들의 값도 업데이트 필요
- 정렬 쿼리: `ORDER BY priority ASC`

### ADR-003: 완료 여부에 따른 자동 분류

**날짜:** 2025-11-25
**상태:** 승인됨
**컨텍스트:** 완료된 할일을 어떻게 관리할지 결정 필요
**결정:** 완료 여부가 true로 변경되면 자동으로 완료 목록으로 이동
**근거:**

- 사용자가 진행중인 작업에만 집중 가능
- 완료된 할일은 따로 보관하여 목록 정리 효과
- 완료된 작업과 진행중 작업의 명확한 분리

**영향:**

- 클라이언트에서 완료 체크 시 UI 업데이트 필요
- 두 가지 뷰(진행중, 완료) 관리 필요

### ADR-004: 영구삭제 기능 제공

**날짜:** 2025-11-25
**상태:** 승인됨
**컨텍스트:** 휴지통의 할일을 어떻게 처리할지 결정 필요
**결정:** Soft Delete된 할일을 물리적으로 삭제하는 영구삭제(Hard Delete) 기능 제공
**근거:**

- 사용자가 명확히 영구 삭제를 원할 때 대응
- 정크 데이터 정리로 데이터베이스 용량 절약
- 기밀 정보 완전 제거 가능

**대안:**

- 영구삭제 기능 미제공: 데이터베이스 용량 지속 증가
- 자동 삭제: 사용자가 원하지 않을 수 있음

**영향:**

- 영구삭제 후 복구 불가능 - 확인 다이얼로그 필수
- 실수로 영구삭제 방지를 위한 UI/UX 고려
- 감사(Audit) 로그에 삭제 기록 필요

---

**문서 버전:** 2.1
**최종 수정일:** 2025-11-25
**작성자:** Domain Expert
**변경 이력:**

- v2.1 (2025-11-25): 휴지통 할일 영구삭제 기능 추가
- v2.0 (2025-11-25): 검증 가능성, 추적성, 비기능적 요구사항 개선
- v1.0 (2025-11-25): 초기 도메인 정의서 작성
